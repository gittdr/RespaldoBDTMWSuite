SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/
CREATE view [dbo].[vista_fe_invoicedetail]

as
SELECT  [ivh_hdrnumber]
      ,[ivd_number]
      ,[stp_number]
      ,[ivd_description]
      ,replace([cht_itemcode],'EQUDED','RENTA') as cht_itemcode
      ,[ivd_quantity]
      ,[ivd_rate]
      ,[ivd_charge]
      ,[ivd_taxable1]
      ,[ivd_taxable2]
      ,[ivd_taxable3]
      ,[ivd_taxable4]
      ,[ivd_unit]
      ,[cur_code]
      ,[ivd_currencydate]
      ,[ivd_glnum]
      ,[ord_hdrnumber]
      ,[ivd_type]
      ,[ivd_rateunit]
      ,[ivd_billto]
      ,[ivd_itemquantity]
      ,[ivd_subtotalptr]
      ,[ivd_allocatedrev]
      ,[ivd_sequence]
      ,[ivd_invoicestatus]
      ,[mfh_hdrnumber]
      ,[ivd_refnum]
      ,[cmd_code]
      ,[cmp_id]
      ,[ivd_distance]
      ,[ivd_distunit]
      ,[ivd_wgt]
      ,[ivd_wgtunit]
      ,[ivd_count]
      ,[ivd_countunit]
      ,[evt_number]
      ,[ivd_reftype]
      ,[ivd_volume]
      ,[ivd_volunit]
      ,[ivd_orig_cmpid]
      ,[timestamp]
      ,[ivd_payrevenue]
      ,[ivd_sign]
      ,[ivd_length]
      ,[ivd_lengthunit]
      ,[ivd_width]
      ,[ivd_widthunit]
      ,[ivd_height]
      ,[ivd_heightunit]
      ,[ivd_exportstatus]
      ,[cht_basisunit]
      ,[ivd_remark]
      ,[tar_number]
      ,[tar_tariffnumber]
      ,[tar_tariffitem]
      ,[ivd_fromord]
      ,[ivd_zipcode]
      ,[ivd_quantity_type]
      ,[cht_class]
      ,[ivd_mileagetable]
      ,[ivd_charge_type]
      ,[ivd_trl_rent]
      ,[ivd_trl_rent_start]
      ,[ivd_trl_rent_end]
      ,[ivd_rate_type]
      ,[last_updateby]
      ,[last_updatedate]
      ,[cht_lh_min]
      ,[cht_lh_rev]
      ,[cht_lh_stl]
      ,[cht_lh_rpt]
      ,[cht_rollintolh]
      ,[cht_lh_prn]
      ,[fgt_number]
      ,[ivd_paylgh_number]
      ,[ivd_tariff_type]
      ,[ivd_taxid]
      ,[ivd_ordered_volume]
      ,[ivd_ordered_loadingmeters]
      ,[ivd_ordered_count]
      ,[ivd_ordered_weight]
      ,[ivd_loadingmeters]
      ,[ivd_loadingmeters_unit]
      ,[ivd_revtype1]
      ,[ivd_hide]
      ,[ivd_baserate]
      ,[ivd_rawcharge]
      ,[ivd_oradjustment]
      ,[ivd_cbadjustment]
      ,[ivd_fsc]
      ,[ivd_splitbillratetype]
      ,[ivd_bolid]
      ,[ivd_shared_wgt]
      ,[ivd_ARTaxAuth]
      ,[ivd_tollcost]
      ,[ivd_miscmoney1]
      ,[ivd_paid_indicator]
      ,[ivd_paid_amount]
      ,[ivd_actual_quantity]
      ,[ivd_actual_unit]
      ,[ivd_tax_basis]
      ,[ivd_loaded_distance]
      ,[ivd_empty_distance]
      ,[fgt_supplier]
      ,[ivd_showas_cmpid]
      ,[ivd_leaseassetid]
      ,[ivd_MaskFromRating]
      ,[ivd_car_key]
      ,[ivd_post_invoice]
      ,[ivd_comment]
      ,[ivd_transdate]
      ,[dw_timestamp]
      ,[ivd_billable_flag]
      ,[ivd_ord_number]
      ,[ivd_ico_pyd_number_parent]
      ,[ivd_description_type]
      ,[ivd_rated_qty]
      ,[ivd_rated_rate]
      ,[dbst_rollinto_tar]
      ,[ivd_allocated_quantity]
      ,[ivd_allocated_rate]
      ,[ivd_allocated_charge]
      ,[ivd_allocated_ivd_number]
      ,[dbsd_id_tariff]
      ,[ivd_allocation_type]
      ,[ivd_allocated_qty]
      ,[ivd_reconcile_tariff]
      ,[ivd_customer_char1]
      ,[ivd_branch]
      ,[ivd_delays]
      ,[ivd_rate_factor]
      ,[ivd_rate_per]
      ,[ivd_sub_charge]
      ,[ivd_discount_rate]
      ,[ivd_discount]
      ,[disc_tar_number]
      ,[ivd_discount_qty]
      ,[ivd_discount_per]
      ,[ivd_definition]
      ,[ivd_pallets]
      ,[ivd_palletunits]
      ,[cmd_NMFC_class]
      ,[cmd_NMFC_rate_class]
      ,[deficit_row]
      ,[ivd_billdate]
  FROM [TMWsuite].[dbo].[invoicedetail]
GO
